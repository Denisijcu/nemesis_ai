#!/usr/bin/env python3
"""
Test de RSA Vulnerability Demo
"""

import sys
sys.path.insert(0, 'src')

from quantum.rsa_vulnerability_demo import RSAVulnerabilityDemo, compare_key_sizes, real_world_projection


def test_basic_rsa():
    """Test bÃ¡sico de RSA"""
    print("=" * 70)
    print("TEST 1: FUNCIONAMIENTO BÃSICO DE RSA")
    print("=" * 70)
    
    demo = RSAVulnerabilityDemo()
    
    # Generar clave pequeÃ±a
    key = demo.generate_small_rsa_key(16)
    
    print(f"\nğŸ”‘ Clave RSA generada:")
    print(f"   n = {key.n}")
    print(f"   e = {key.e}")
    print(f"   d = {key.d}")
    print(f"   p = {key.p}, q = {key.q}")
    
    # Cifrar
    message = 123
    ciphertext = demo.encrypt(message, key)
    
    print(f"\nğŸ“¨ Cifrado:")
    print(f"   Mensaje:  {message}")
    print(f"   Cifrado:  {ciphertext}")
    
    # Descifrar
    decrypted = demo.decrypt(ciphertext, key)
    
    print(f"\nğŸ”“ Descifrado:")
    print(f"   Resultado: {decrypted}")
    print(f"   âœ… Correcto: {decrypted == message}")
    
    print()


def test_vulnerability_demo():
    """Test de demostraciÃ³n completa"""
    print("=" * 70)
    print("TEST 2: DEMOSTRACIÃ“N DE VULNERABILIDAD")
    print("=" * 70)
    
    demo = RSAVulnerabilityDemo()
    
    # Demo con clave de 32 bits
    result = demo.demonstrate_vulnerability(32)
    
    print("\nâœ… DemostraciÃ³n completada")
    print(f"   Mensaje comprometido: {result['message_compromised']}")
    print(f"   Speedup cuÃ¡ntico: {result['speedup']:.1f}x")
    
    print()


def main():
    print()
    print("â•”" + "â•" * 68 + "â•—")
    print("â•‘" + " " * 18 + "RSA VULNERABILITY DEMO - TESTS" + " " * 20 + "â•‘")
    print("â•š" + "â•" * 68 + "â•")
    print()
    
    test_basic_rsa()
    print()
    
    test_vulnerability_demo()
    print()
    
    # ComparaciÃ³n de tamaÃ±os
    compare_key_sizes()
    print()
    
    # ProyecciÃ³n mundo real
    real_world_projection()
    print()
    
    print("=" * 70)
    print("âœ… TODOS LOS TESTS COMPLETADOS")
    print("=" * 70)
    print()
    
    print("âš›ï¸ CAPÃTULO 7 - PARTE 2 COMPLETADA:")
    print("   âœ… ImplementaciÃ³n de RSA bÃ¡sica")
    print("   âœ… DemostraciÃ³n de cifrado/descifrado")
    print("   âœ… Ataque clÃ¡sico (factorizaciÃ³n)")
    print("   âœ… SimulaciÃ³n de Shor (ataque cuÃ¡ntico)")
    print("   âœ… ComparaciÃ³n de tiempos")
    print("   âœ… ProyecciÃ³n para claves reales")
    print()
    print("ğŸ¯ RSA ES VULNERABLE. Post-Quantum Crypto es el futuro!")
    print()


if __name__ == "__main__":
    main()